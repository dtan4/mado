#!/usr/bin/env ruby

require "mado"
require "optparse"
require "pathname"

options = {}

# TODO: show correct usage

argv = OptionParser.new do |opt|
  opt.on("-p port", "Port number (default: 8080)") { |val| options[:port] = val.to_i }
  opt.on("-o addr", "Address to bind (default: 0.0.0.0)") { |val| options[:host] = val }
  opt.on("--debug", "Debug mode") { |val| options[:debug] = val }
end.parse(ARGV)

if argv.length < 1
  exit 1
end

options[:markdown] = Pathname.new(argv.shift).realpath.to_s

Mado::Server.run(options)
